<%- title "#{@category.name} - omnigoat design" %>

<div class="window lg">
  <h1> <%= @category.name %> <span class="badge"><%= @posts.count %>/<%= @category.posts.count %></span> </h1>
  <div class="panel-collection" fade-children>
    <% @posts.each_with_index do |p,k| %><%= render 'posts/postlink', p: p, k: k, :info => {:time => p.time_updated} %><% end %>
  </div>
</div>

<% if pages(@category.posts, @q) > 1 then %>
  <%= render "posts/pagination", pages: pages(@category.posts, @q), size: 9 %>
<% end %>

<% content_for :actions do %>
  <div class="actions-category">
    <div class="actions-header">Category Actions</div>
    <%= link_to 'New post', new_post_path, class:"tag" %>
    <%= link_to 'Delete', category_path(@category), method: "delete", class:"tag" %>
  </div>
<% end %>

<% if authorized? then %>
  <div class="window form">
    <%= form_for @category do |f| %>

    <div class="group">
      <%= f.file_field :icon %>
    </div>

    <div class="group">
      <%= f.label :name, class:"label"%>
      <%= f.text_field :name, class:"input field"%>
    </div>

    <div class="group">
      <%= f.label :color_hex, class:"label"%>
      <%= f.text_field :color_hex, class:"input field"%>
    </div>

    <div class="group">
      <%= f.submit "Update " + @category.name, class:"input button"%>
    </div>
    <% end %>
  </div>
<% end %>
