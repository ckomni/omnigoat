<div class="window">
  <h1>Categories</h1>
</div>
<div class="window">
  <div class="panel-collection" fade-children>
<% @categories.each do |c| %>
  <div class="panel-container">
    <%= link_to posts_path(c.name), class:"category-link panel" do %>
    <div class="panel-details">
      <div class="category-name">
        <%= c.name %>
      </div>
      <div class="category-posts">
        <div><%= pluralize(c.posts.count, "post") %></div>
      </div>
    </div>
    <div class="panel-background icon", image_no="0", data-image="<%= c.icon.url %>"></div>
    <% end %>
  </div>
<% end %>
  </div>
</div>

<div class="window">
  <div class="panel-collection" fade-children>
    <% @posts.each_with_index do |p,k| %><%=
      render 'posts/postlink', p: p, k: k, :info => {:category => p.category.name.humanize, :time => p.time_updated}
      %><% end %>
  </div>
</div>


<% if pages(Post.all, @q) > 1 then %>
  <div class="window blank">
    <%= render "posts/pagination", pages: pages(Post.all, @q), size: 7 %>
  </div>
<% end %>

<% if authorized? then %>
  <div class="window form">
    <%= form_for @category do |f| %>

    <div class="group">
      <%= f.file_field :icon %>
    </div>

    <div class="group">
      <%= f.label :name, class:"label"%>
      <%= f.text_field :name, class:"input field"%>
    </div>

    <div class="group">
      <%= f.label :color_hex, class:"label"%>
      <%= f.text_field :color_hex, class:"input field"%>
    </div>

    <div class="group">
      <%= f.submit "Create Category", class:"input button"%>
    </div>
    <% end %>
  </div>
<% end %>
